import { expect } from 'chai'
import { expandTo18Decimals } from '../src/utils/expandTo18Decimals'
import { SwapRouter } from '../src/swapRouter'
import { TokenTypes, Markets } from '../src/entities/NFTTrade'
import { CurrencyAmount, Currency, Ether } from '@uniswap/sdk-core'
import { FoundationTrade, FoundationData } from '../src/entities/protocols/foundation'

const ETHER = Ether.onChain(1)
const SAMPLE_ADDR = '0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'
const FOUNDATION_REFERRER = '0x459e213D8B5E79d706aB22b945e3aF983d51BC4C'

const foundationData: FoundationData = {
  referrer: FOUNDATION_REFERRER,
}

const FOUNDATION_BUY_ITEM = {
  address: '0xEf96021Af16BD04918b0d87cE045d7984ad6c38c',
  tokenId: 32,
  priceInfo: CurrencyAmount.fromRawAmount(ETHER, expandTo18Decimals(0.01)),
  tokenType: TokenTypes.ERC721,
  data: foundationData,
}
const FOUNDATION_TRADE = new FoundationTrade(SAMPLE_ADDR, [FOUNDATION_BUY_ITEM])

describe('SwapRouter', () => {
  it('encodes a foundation trade', async () => {
    const methodParameters = SwapRouter.swapGenieCallParameters([FOUNDATION_TRADE])
    expect(methodParameters.value).to.eq(FOUNDATION_BUY_ITEM.priceInfo.quotient.toString())
    expect(methodParameters.calldata).to.eq(
      '0x24856bc30000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000010f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000002386f26fc1000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa000000000000000000000000ef96021af16bd04918b0d87ce045d7984ad6c38c00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000084b01ef608000000000000000000000000ef96021af16bd04918b0d87ce045d7984ad6c38c0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000002386f26fc10000000000000000000000000000459e213d8b5e79d706ab22b945e3af983d51bc4c00000000000000000000000000000000000000000000000000000000'
    )
  })
})
